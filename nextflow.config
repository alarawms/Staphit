/*
 * Staphit Pipeline - IBEX Configuration
 */

params {
    input         = 'samplesheet.csv'
    outdir        = './results'
    species       = null
    search_limit  = 100
    max_downloads = 50
}

profiles {
    ibex {
        process {
            executor       = 'slurm'
            queue          = 'batch'
            clusterOptions = '--constraint=intel'
            beforeScript   = 'module load singularity'
            
            cpus   = 4
            memory = 16.GB
            time   = '4h'
            
            withName: 'SPADES|ASSEMBLY'   { cpus = 8; memory = 64.GB; time = '12h' }
            withName: 'PROKKA|ANNOTATION' { cpus = 8; memory = 32.GB; time = '6h' }
            withName: 'PANAROO'           { cpus = 8; memory = 32.GB; time = '8h' }
            withName: 'IQTREE'            { cpus = 8; memory = 32.GB; time = '12h' }
        }
        
        singularity {
            enabled     = true
            autoMounts  = true
            cacheDir    = "${projectDir}/singularity_cache"
            pullTimeout = '2h'
        }
        
        docker.enabled = false
    }
}
